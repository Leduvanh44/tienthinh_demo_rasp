# âš™ï¸ Há»† THá»NG GIÃM SÃT DÃ‚Y CHUYá»€N Sáº¢N XUáº¤T DÃ‚Y Äá»’NG TRÃNG MEN

## ğŸ­ Tá»•ng Quan DÃ¢y Chuyá»n
<p align="center">
  <img src="images/dc.png" alt="SÆ¡ Ä‘á»“ cá»§a má»™t dÃ¢y chuyá»n sáº£n xuáº¥t. " width="700">
</p>
DÃ¢y chuyá»n sáº£n xuáº¥t **dÃ¢y Ä‘á»“ng trÃ¡ng men** bao gá»“m **bá»‘n há»‡ thá»‘ng chÃ­nh**, má»—i há»‡ thá»‘ng Ä‘áº£m nhiá»‡m má»™t vai trÃ² quan trá»ng nháº±m Ä‘áº£m báº£o **cháº¥t lÆ°á»£ng vÃ  hiá»‡u suáº¥t sáº£n xuáº¥t tá»‘i Æ°u**:

1. **Há»‡ thá»‘ng Ä‘o Ä‘Æ°á»ng kÃ­nh dÃ¢y**  
2. **Há»‡ thá»‘ng gia nhiá»‡t vÃ  trÃ¡ng men**  
3. **Há»‡ thá»‘ng soi lá»— kim**  
4. **Há»‡ thá»‘ng cuá»™n dÃ¢y tá»± Ä‘á»™ng**

ToÃ n bá»™ dÃ¢y chuyá»n Ä‘Æ°á»£c **giÃ¡m sÃ¡t vÃ  Ä‘iá»u khiá»ƒn thÃ´ng qua Raspberry Pi 3 B+**, HMI, vÃ  pháº§n má»m chuyÃªn dá»¥ng, giÃºp:
- Quáº£n lÃ½ dá»¯ liá»‡u táº­p trung  
- PhÃ¡t hiá»‡n sá»›m lá»—i ká»¹ thuáº­t  
- PhÃ¢n tÃ­ch vÃ  tá»‘i Æ°u hÃ³a quy trÃ¬nh váº­n hÃ nh  

---

## ğŸ” Chi Tiáº¿t CÃ¡c Há»‡ Thá»‘ng

### 1ï¸âƒ£ Há»‡ thá»‘ng Ä‘o Ä‘Æ°á»ng kÃ­nh dÃ¢y
- LÃ  **bÆ°á»›c Ä‘áº§u tiÃªn** trong quy trÃ¬nh sáº£n xuáº¥t.  
- Má»¥c tiÃªu: kiá»ƒm tra vÃ  giÃ¡m sÃ¡t Ä‘Æ°á»ng kÃ­nh dÃ¢y Ä‘á»“ng trong suá»‘t quÃ¡ trÃ¬nh kÃ©o dÃ¢y.  
- Sá»­ dá»¥ng thiáº¿t bá»‹ Ä‘o chuyÃªn dá»¥ng (**tá»‘i Ä‘a 32 line Ä‘o Ä‘á»“ng thá»i**).  
- Dá»¯ liá»‡u hiá»ƒn thá»‹ trÃªn **mÃ n hÃ¬nh HMI**, giÃºp ngÆ°á»i váº­n hÃ nh theo dÃµi vÃ  Ä‘iá»u chá»‰nh ká»‹p thá»i.  

#### ğŸ“‹ ThÃ nh pháº§n:
- MÃ¡y Ä‘o Ä‘Æ°á»ng kÃ­nh dÃ¢y (tá»‘i Ä‘a 32 line)  
- HMI truyá»n thÃ´ng vá»›i mÃ¡y Ä‘o  

---

### 2ï¸âƒ£ Há»‡ thá»‘ng gia nhiá»‡t vÃ  trÃ¡ng men
- Äáº£m báº£o **lá»›p cÃ¡ch Ä‘iá»‡n hoÃ n háº£o** cho dÃ¢y Ä‘á»“ng.  
- Gá»“m 4 bá»™ Ä‘iá»u khiá»ƒn nhiá»‡t Ä‘iá»‡n trá»Ÿ Ä‘á»ƒ **gia nhiá»‡t dÃ¢y trÆ°á»›c khi trÃ¡ng men**, vÃ  3 bá»™ Ä‘iá»u khiá»ƒn nhiá»‡t Ä‘á»™ tá»•ng thá»ƒ.  
- 5 biáº¿n táº§n Ä‘iá»u khiá»ƒn **quáº¡t lÃ m mÃ¡t vÃ  Ä‘á»™ng cÆ¡ kÃ©o dÃ¢y**, giÃºp **tá»‘i Æ°u tá»‘c Ä‘á»™ vÃ  hiá»‡u quáº£ truyá»n nhiá»‡t**.  

#### ğŸ“‹ ThÃ nh pháº§n:
- 7 bá»™ Ä‘iá»u khiá»ƒn nhiá»‡t Ä‘á»™  
- 5 biáº¿n táº§n Ä‘iá»u khiá»ƒn quáº¡t vÃ  Ä‘á»™ng cÆ¡  

---

### 3ï¸âƒ£ Há»‡ thá»‘ng soi lá»— kim
- Kiá»ƒm tra lá»›p cÃ¡ch Ä‘iá»‡n Ä‘á»ƒ phÃ¡t hiá»‡n **cÃ¡c lá»—i vi mÃ´ (lá»— kim)** khÃ´ng thá»ƒ tháº¥y báº±ng máº¯t thÆ°á»ng.  
- Gá»“m **mÃ¡y soi chuyÃªn dá»¥ng** káº¿t ná»‘i vá»›i **mÃ¡y tÃ­nh Ä‘iá»u khiá»ƒn** Ä‘á»ƒ cháº¡y pháº§n má»m giÃ¡m sÃ¡t vÃ  xá»­ lÃ½ tÃ­n hiá»‡u.  

#### ğŸ“‹ ThÃ nh pháº§n:
- MÃ¡y soi lá»— kim  
- MÃ¡y tÃ­nh cháº¡y pháº§n má»m Ä‘iá»u khiá»ƒn  

---

### 4ï¸âƒ£ Há»‡ thá»‘ng cuá»™n dÃ¢y tá»± Ä‘á»™ng
- Cuá»™n dÃ¢y Ä‘á»“ng thÃ nh **cÃ¡c cuá»™n gá»n gÃ ng, Ä‘á»“ng Ä‘á»u**, sáºµn sÃ ng cho Ä‘Ã³ng gÃ³i vÃ  váº­n chuyá»ƒn.  
- Hoáº¡t Ä‘á»™ng **liÃªn tá»¥c vÃ  Ä‘á»“ng bá»™** vá»›i cÃ¡c há»‡ thá»‘ng phÃ­a trÆ°á»›c, Ä‘áº£m báº£o khÃ´ng giÃ¡n Ä‘oáº¡n dÃ¢y chuyá»n.  

---

## ğŸ§  SÆ¡ Äá»“ NguyÃªn LÃ½
<p align="center">
  <img src="images/sdnl.png" alt="SÆ¡ Ä‘á»“ nguyÃªn lÃ½ cá»§a má»™t há»‡ thá»‘ng" width="700">
</p>
Há»‡ thá»‘ng gá»“m:
- **Bá»™ thu tháº­p dá»¯ liá»‡u (Raspberry Pi 3 B+)** lÃ m thiáº¿t bá»‹ trung tÃ¢m  
- Káº¿t ná»‘i cÃ¡c thiáº¿t bá»‹ cÃ´ng nghiá»‡p qua **RS-485 (Modbus RTU)** vÃ  **Ethernet (Modbus TCP)**  
- Gá»­i dá»¯ liá»‡u vá» **server qua giao thá»©c MQTT**  
- Server tiáº¿p nháº­n dá»¯ liá»‡u tá»« MQTT Broker thÃ´ng qua thÆ° viá»‡n MQTTnet, lÆ°u trá»¯ vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u vÃ  cung cáº¥p cÃ¡c API Ä‘á»ƒ hiá»ƒn thá»‹ thÃ´ng tin trÃªn giao diá»‡n ngÆ°á»i dÃ¹ng. 
- NgÆ°á»i quáº£n lÃ½ cÃ³ thá»ƒ truy cáº­p há»‡ thá»‘ng tá»« xa Ä‘á»ƒ giÃ¡m sÃ¡t, cáº£nh bÃ¡o vÃ  trÃ­ch xuáº¥t bÃ¡o cÃ¡o má»i lÃºc má»i nÆ¡i thÃ´ng qua trÃ¬nh duyá»‡t web trÃªn mÃ¡y tÃ­nh hoáº·c Ä‘iá»‡n thoáº¡i.


### ğŸ§© Káº¿t ná»‘i pháº§n cá»©ng:
<p align="center">
  <img src="images/sx.png" alt="Bá»™ thu tháº­p dá»¯ liá»‡u" width="700">
</p>
- Raspberry Pi káº¿t ná»‘i vá»›i cÃ¡c thiáº¿t bá»‹ Ä‘o lÆ°á»ng vÃ  HMI qua **RS-485**  
- Káº¿t ná»‘i tá»›i **PC vÃ  Server** qua **switch Ethernet**  
- Truyá»n dá»¯ liá»‡u qua **MQTT Broker** Ä‘á»ƒ hiá»ƒn thá»‹ trÃªn giao diá»‡n web  

---

## ğŸŒ Kiáº¿n TrÃºc Giao Tiáº¿p Dá»¯ Liá»‡u Cá»§a Bá»™ Thu Tháº­p Dá»¯ Liá»‡u

Há»‡ thá»‘ng sá»­ dá»¥ng **4 luá»“ng chÃ­nh** Ä‘á»ƒ thu tháº­p vÃ  Ä‘á»“ng bá»™ dá»¯ liá»‡u:

| Luá»“ng | Chá»©c nÄƒng | Giao thá»©c |
|-------|------------|-----------|
| **Modbus RTU** | Thu tháº­p dá»¯ liá»‡u tá»« thiáº¿t bá»‹ qua RS-485 | Modbus |
| **Modbus TCP** | Giao tiáº¿p nhanh qua Ethernet | TCP/IP |
| **PC-Ethernet** | Káº¿t ná»‘i vÃ  truy váº¥n dá»¯ liá»‡u tá»« SQL/Excel | SMB + SQL |
| **MQTT** | Truyá»n dá»¯ liá»‡u thá»i gian thá»±c lÃªn server/web | MQTT |

Táº¥t cáº£ cÃ¡c luá»“ng Ä‘á»u sá»­ dá»¥ng cÆ¡ cháº¿ **ThreadingLock** Ä‘á»ƒ Ä‘áº£m báº£o **Ä‘á»“ng bá»™ dá»¯ liá»‡u Ä‘a luá»“ng** vÃ  **trÃ¡nh xung Ä‘á»™t khi Ä‘á»c/ghi**.

---

## âš¡ CÆ¡ Cháº¿ Xá»­ LÃ½ Lá»—i

- â± **Timeout** â†’ gÃ¡n giÃ¡ trá»‹ `-1`, ghi nháº­t kÃ½ lá»—i  
- âš ï¸ **MÃ£ lá»—i Modbus** â†’ lÆ°u `E{error_code}` vÃ o log  
- ğŸ’¾ **MQTT retry mechanism** â†’ thá»­ láº¡i 3â€“5 láº§n, lÆ°u báº£n sao dá»¯ liá»‡u náº¿u tháº¥t báº¡i  
- ğŸ” **ThreadingLock** â†’ Ä‘áº£m báº£o dá»¯ liá»‡u nháº¥t quÃ¡n giá»¯a cÃ¡c luá»“ng  

---

## ğŸ§® CÆ¡ Cháº¿ PC-Ethernet

- Káº¿t ná»‘i tá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u SQL hoáº·c file `.db`/Excel trÃªn PC qua **giao thá»©c SMB**  
- Ãnh xáº¡ Ä‘Æ°á»ng dáº«n Ä‘áº¿n `/mnt/pcshare` trÃªn Raspberry Pi  
- Truy váº¥n trá»±c tiáº¿p cÃ¡c giÃ¡ trá»‹ giÃ¡m sÃ¡t vÃ  Ä‘á»“ng bá»™ vÃ o **ThreadingLock**  
- Xá»­ lÃ½ lá»—i: máº¥t káº¿t ná»‘i, lá»—i xÃ¡c thá»±c SMB, lá»—i truy váº¥n SQL  

---

## ğŸ“¡ Giao Tiáº¿p MQTT

- ÄÃ³ng gÃ³i dá»¯ liá»‡u dÆ°á»›i dáº¡ng **JSON**  
- Truyá»n dá»¯ liá»‡u lÃªn **MQTT Broker**  
- CÃ¡c há»‡ thá»‘ng khÃ¡c cÃ³ thá»ƒ **subscribe** Ä‘á»ƒ nháº­n dá»¯ liá»‡u thá»i gian thá»±c  
- Dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u cá»¥c bá»™ khi máº¥t káº¿t ná»‘i Ä‘á»ƒ **trÃ¡nh máº¥t mÃ¡t thÃ´ng tin**  

---

## ğŸ§­ Giao Diá»‡n Web
Giao diá»‡n web quáº£n lÃ½ cÃ³ 5 trang chÃ­nh:

| Trang | MÃ´ táº£ |  
|--------|--------|  
| ğŸ” **LOGIN** | Trang Ä‘Äƒng nháº­p ngÆ°á»i dÃ¹ng |  
| ğŸ“Š **DASHBOARD** | Trang trung tÃ¢m hiá»ƒn thá»‹ tá»•ng quan dá»¯ liá»‡u há»‡ thá»‘ng |  
| ğŸ“ˆ **DATA DETAIL** | Trang dá»¯ liá»‡u chi tiáº¿t tá»«ng thÃ´ng sá»‘ (Temperature, Fan, Copper Diameter, LEAR, â€¦) |  
| âš ï¸ **ERROR HISTORY** | Trang lá»‹ch sá»­ lá»—i váº­n hÃ nh |  
| ğŸ“‘ **REPORT** | Trang bÃ¡o cÃ¡o: Report Chart, Export Excel, Report History |

MÃ£ nguá»“n (front-end) cá»§a pháº§n má»m giÃ¡m sÃ¡t vÃ  web cÃ³ táº¡i:
ğŸ‘‰ [https://github.com/Leduvanh44/tienthinh_demo.git](https://github.com/Leduvanh44/tienthinh_demo.git)

---

